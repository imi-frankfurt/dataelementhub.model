{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "type": "object",
  "title": "The DataElementHub-element Schema",
  "definitions": {
    "identification": {
      "type": "object",
      "required": [
        "elementType"
      ],
      "definitions": {
        "namespaceUrn": {
          "type": "string",
          "pattern": "^[uU][rR][nN]:[0-9]+:[nN][aA][mM][eE][sS][pP][aA][cC][eE]:[0-9]+:[0-9]+$"
        },
        "dataElementUrn": {
          "type": "string",
          "pattern": "^[uU][rR][nN]:[0-9]+:[dD][aA][tT][aA][eE][lL][eE][mM][eE][nN][tT]:[0-9]+:[0-9]+$"
        },
        "dataElementGroupUrn": {
          "type": "string",
          "pattern": "^[uU][rR][nN]:[0-9]+:[dD][aA][tT][aA][eE][lL][eE][mM][eE][nN][tT][gG][rR][oO][uU][pP]:[0-9]+:[0-9]+$"
        },
        "recordUrn": {
          "type": "string",
          "pattern": "^[uU][rR][nN]:[0-9]+:[rR][eE][cC][oO][rR][dD]:[0-9]+:[0-9]+$"
        },
        "permittedValueUrn": {
          "type": "string",
          "pattern": "^[uU][rR][nN]:[0-9]+:[pP][eE][rR][mM][iI][tT][tT][eE][dD][vV][aA][lL][uU][eE]:[0-9]+:[0-9]+$"
        },
        "valueDomainUrn": {
          "type": "string",
          "pattern": "^[uU][rR][nN]:[0-9]+:[vV][aA][lL][uU][eE][dD][oO][mM][aA][iI][nN]:[0-9]+:[0-9]+$"
        }
      },
      "additionalProperties": false,
      "properties": {
        "elementType": {
          "type": "string",
          "required": [
            "namespaceUrn"
          ],
          "enum": [
            "DATAELEMENT",
            "DATAELEMENTGROUP",
            "RECORD",
            "NAMESPACE",
            "DESCRIBED_VALUE_DOMAIN",
            "ENUMERATED_VALUE_DOMAIN",
            "PERMISSIBLE_VALUE"
          ]
        },
        "hideNamespace": {
          "type": "boolean",
          "default": false
        },
        "identifier": {
          "type": "integer"
        },
        "namespaceId": {
          "type": "integer"
        },
        "namespaceUrn": {
          "type": "string"
        },
        "revision": {
          "type": "integer"
        },
        "status": {
          "type": "string",
          "enum": [
            "DRAFT",
            "RELEASED",
            "OUTDATED",
            "STAGED"
          ]
        },
        "urn": {
          "type": "string",
          "oneOf": [
            {
              "$ref": "#/definitions/identification/definitions/namespaceUrn"
            },
            {
              "$ref": "#/definitions/identification/definitions/dataElementUrn"
            },
            {
              "$ref": "#/definitions/identification/definitions/dataElementGroupUrn"
            },
            {
              "$ref": "#/definitions/identification/definitions/recordUrn"
            },
            {
              "$ref": "#/definitions/identification/definitions/valueDomainUrn"
            },
            {
              "$ref": "#/definitions/identification/definitions/permittedValueUrn"
            }
          ]
        }
      }
    },
    "definitions": {
      "type": "array",
      "minItems": 1,
      "definitions": {
        "definition": {
          "type": "object",
          "required": [
            "designation",
            "language"
          ],
          "additionalProperties": false,
          "properties": {
            "designation": {
              "type": "string"
            },
            "definition": {
              "type": "string"
            },
            "language": {
              "enum": [
                "en",
                "bg",
                "es",
                "cz",
                "da",
                "de",
                "et",
                "el",
                "fr",
                "ga",
                "hr",
                "it",
                "lv",
                "lt",
                "hu",
                "mt",
                "nl",
                "pl",
                "pt",
                "ro",
                "sk",
                "sl",
                "fi",
                "sv"
              ]
            }
          }
        }
      },
      "items": {
        "$ref": "#/definitions/definitions/definitions/definition"
      }
    },
    "slots": {
      "type": "array",
      "definitions": {
        "slot": {
          "type": "object",
          "required": [
            "name",
            "value"
          ],
          "properties": {
            "slot_name": {
              "type": "string"
            },
            "slot_value": {
              "type": "string"
            }
          }
        }
      },
      "items": {
        "$ref": "#/definitions/slots/definitions/slot"
      }
    },
    "permittedValue": {
      "type": "object",
      "required": ["identification"],
      "oneOf": [
        {
          "required": [
            "definitions",
            "value"
          ]
        },
        {
          "required": [
            "urn"
          ]
        }
      ],
      "additionalProperties": false,
      "properties": {
        "identification": {
          "required": ["elementType", "namespaceUrn", "status"],
          "not": {
            "required": ["hideNamespace"]
          },
          "additionalProperties": false,
          "properties": {
            "elementType": {
              "enum": [
                "PERMISSIBLE_VALUE"
              ]
            },
            "hideNamespace": {
              "$ref": "#/definitions/identification/properties/hideNamespace"
            },
            "identifier": {
              "$ref": "#/definitions/identification/properties/identifier"
            },
            "namespaceId": {
              "$ref": "#/definitions/identification/properties/namespaceId"
            },
            "namespaceUrn": {
              "$ref": "#/definitions/identification/properties/namespaceUrn"
            },
            "revision": {
              "$ref": "#/definitions/identification/properties/revision"
            },
            "status": {
              "$ref": "#/definitions/identification/properties/status"
            },
            "urn": {
              "$ref": "#/definitions/identification/definitions/permittedValueUrn"
            }
          }
        },
        "definitions": {
          "$ref": "#/definitions/definitions"
        },
        "slots": {
          "$ref": "#/definitions/slots"
        },
        "value": {
          "type": "string"
        },
        "urn": {
          "type": "string"
        },
        "conceptAssociations": {
          "$ref": "#/definitions/conceptAssociations"
        }
      }
    },
    "valueDomain": {
      "type": "object",
      "required": [
        "identification",
        "definitions",
        "type"
      ],
      "definitions": {
        "text": {
          "type": "object",
          "required": [
            "useRegEx",
            "useMaximumLength"
          ],
          "additionalProperties": false,
          "properties": {
            "useRegEx": {
              "type": "boolean"
            },
            "useMaximumLength": {
              "type": "boolean"
            },
            "regEx": {
              "type": "string"
            },
            "maximumLength": {
              "type": "number"
            }
          },
          "allOf": [
            {
              "if": {
                "properties": {
                  "useRegEx": {
                    "const": true
                  }
                }
              },
              "then": {
                "required": [
                  "regEx"
                ]
              }
            },
            {
              "if": {
                "properties": {
                  "useMaximumLength": {
                    "const": true
                  }
                }
              },
              "then": {
                "required": [
                  "maximumLength"
                ]
              }
            }
          ]
        },
        "dateTime": {
          "type": "object",
          "oneOf": [
            {
              "required": ["date"]
            },
            {
              "required": ["date", "time", "hourFormat"]
            },
            {
              "required": ["time", "hourFormat"]
            }
          ],
          "additionalProperties": false,
          "properties": {
            "date": {
              "oneOf": [
                {
                  "type": "string",
                  "pattern": "^YYYY-MM-DD$"
                },
                {
                  "type": "string",
                  "pattern": "^YYYY-MM$"
                },
                {
                  "type": "string",
                  "pattern": "^DD.MM.YYYY$"
                },
                {
                  "type": "string",
                  "pattern": "^MM.YYYY$"
                }
              ]
            },
            "time": {
              "oneOf": [
                {
                  "type": "string",
                  "pattern": "^hh:mm:ss$"
                },
                {
                  "type": "string",
                  "pattern": "^hh:mm$"
                }
              ]
            },
            "hourFormat": {
              "type": "string",
              "pattern": "^24h|12h$"
            }
          }
        },
        "permittedValues": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/permittedValue"
          }
        },
        "numeric": {
          "type": "object",
          "required": [
            "type"
          ],
          "additionalProperties": false,
          "properties": {
            "type": {
              "type": "string"
            },
            "useMinimum": {
              "type": "boolean"
            },
            "useMaximum": {
              "type": "boolean"
            },
            "unitOfMeasure": {
              "type": "string"
            },
            "minimum": {
              "type": "number"
            },
            "maximum": {
              "type": "number"
            }
          },
          "allOf": [
            {
              "if": {
                "properties": {
                  "useMinimum": {
                    "const": true
                  }
                }
              },
              "then": {
                "required": [
                  "minimum"
                ]
              }
            },
            {
              "if": {
                "properties": {
                  "useMaximum": {
                    "const": true
                  }
                }
              },
              "then": {
                "required": [
                  "maximum"
                ]
              }
            }
          ]
        }
      },
      "additionalProperties": false,
      "properties": {
        "identification": {
          "required": ["namespaceUrn", "status"],
          "not": {
            "required": ["hideNamespace"]
          },
          "additionalProperties": false,
          "properties": {
            "elementType": {
              "enum": [
                "DESCRIBED_VALUE_DOMAIN",
                "ENUMERATED_VALUE_DOMAIN"
              ]
            },
            "hideNamespace": {
              "$ref": "#/definitions/identification/properties/hideNamespace"
            },
            "identifier": {
              "$ref": "#/definitions/identification/properties/identifier"
            },
            "namespaceId": {
              "$ref": "#/definitions/identification/properties/namespaceId"
            },
            "namespaceUrn": {
              "$ref": "#/definitions/identification/properties/namespaceUrn"
            },
            "revision": {
              "$ref": "#/definitions/identification/properties/revision"
            },
            "status": {
              "$ref": "#/definitions/identification/properties/status"
            },
            "urn": {
              "$ref": "#/definitions/identification/definitions/valueDomainUrn"
            }
          }
        },
        "definitions": {
          "$ref": "#/definitions/definitions"
        },
        "slots": {
          "$ref": "#/definitions/slots"
        },
        "type": {
          "type": "string",
          "enum": [
            "BOOLEAN",
            "NUMERIC",
            "STRING",
            "ENUMERATED",
            "DATE",
            "DATETIME",
            "TIME",
            "TBD"
          ]
        },
        "numeric": {
          "$ref": "#/definitions/valueDomain/definitions/numeric"
        },
        "text": {
          "$ref": "#/definitions/valueDomain/definitions/text"
        },
        "permittedValues": {
          "$ref": "#/definitions/valueDomain/definitions/permittedValues"
        },
        "conceptAssociations": {
          "$ref": "#/definitions/conceptAssociations"
        }
      },
      "allOf": [
        {
          "if": {
            "properties": {
              "type": {
                "enum": ["FLOAT", "INTEGER"]
              }
            }
          },
          "then": {
            "required": [
              "numeric"
            ],
            "not": {
              "required": ["text", "permittedValues", "datetime"]
            }
          }
        },
        {
          "if": {
            "properties": {
              "type": {
                "const": "STRING"
              }
            }
          },
          "then": {
            "required": [
              "text"
            ],
            "not": {
              "required": ["numeric", "permittedValues", "datetime"]
            }
          }
        },
        {
          "if": {
            "properties": {
              "type": {
                "const": "DATE"
              }
            }
          },
          "then": {
            "required": [
              "datetime"
            ],
            "not": {
              "required": ["text", "permittedValues", "numeric"]
            },
            "properties": {
              "datetime": {
                "required": [
                  "date"
                ],
                "$ref": "#/definitions/valueDomain/definitions/dateTime"
              }
            }
          }
        },
        {
          "if": {
            "properties": {
              "type": {
                "const": "DATETIME"
              }
            }
          },
          "then": {
            "required": [
              "datetime"
            ],
            "not": {
              "required": ["text", "permittedValues", "numeric"]
            },
            "properties": {
              "datetime": {
                "required": [
                  "date",
                  "time",
                  "hourFormat"
                ],
                "$ref": "#/definitions/valueDomain/definitions/dateTime"
              }
            }
          }
        },
        {
          "if": {
            "properties": {
              "type": {
                "const": "TIME"
              }
            }
          },
          "then": {
            "required": [
              "datetime"
            ],
            "not": {
              "required": ["text", "permittedValues", "numeric"]
            },
            "properties": {
              "datetime": {
                "required": [
                  "time",
                  "hourFormat"
                ],
                "$ref": "#/definitions/valueDomain/definitions/dateTime"
              }
            }
          }
        },
        {
          "if": {
            "properties": {
              "type": {
                "const": "ENUMERATED"
              }
            }
          },
          "then": {
            "required": [
              "permittedValues"
            ],
            "not": {
              "required": ["text", "datetime", "numeric"]
            }
          }
        }
      ]
    },
    "conceptAssociations": {
      "type": "array",
      "definitions": {
        "conceptAssociation": {
          "type": "object",
          "required": [
            "system",
            "version",
            "term",
            "text",
            "linktype"
          ],
          "properties": {
            "system": {
              "type": "string"
            },
            "version": {
              "type": "string"
            },
            "term": {
              "type": "string"
            },
            "text": {
              "type": "string"
            },
            "linktype": {
              "enum": [
                "undefined",
                "equal",
                "equivalent",
                "wider",
                "subsumes",
                "narrower",
                "specializes",
                "inexact"
              ]
            }
          }
        }
      },
      "items": {
        "$ref": "#/definitions/conceptAssociations/definitions/conceptAssociation"
      }
    },
    "members": {
      "type": "array",
      "definitions": {
        "member": {
          "type": "object",
          "required": [
            "elementUrn"
          ],
          "properties": {
            "elementUrn": {
              "$ref": "#/definitions/identification/properties/urn"
            },
            "order": {
              "type": "integer"
            },
            "status": {
              "$ref": "#/definitions/identification/properties/status"
            }
          }
        }
      },
      "items": {
        "$ref": "#/definitions/members/definitions/member"
      }
    },
    "dataElement": {
      "additionalProperties": false,
      "oneOf": [
        {
          "required": ["valueDomain"]
        },
        {
          "required": ["valueDomainUrn"]
        }
      ],
      "required": ["identification", "definitions"],
      "properties": {
        "identification": {
          "required": ["status", "namespaceUrn"],
          "not": {
            "required": ["hideNamespace"]
          },
          "additionalProperties": false,
          "properties": {
            "elementType": {
              "enum": [
                "DATAELEMENT"
              ]
            },
            "hideNamespace": {
              "$ref": "#/definitions/identification/properties/hideNamespace"
            },
            "identifier": {
              "$ref": "#/definitions/identification/properties/identifier"
            },
            "namespaceId": {
              "$ref": "#/definitions/identification/properties/namespaceId"
            },
            "namespaceUrn": {
              "$ref": "#/definitions/identification/properties/namespaceUrn"
            },
            "revision": {
              "$ref": "#/definitions/identification/properties/revision"
            },
            "status": {
              "$ref": "#/definitions/identification/properties/status"
            },
            "urn": {
              "$ref": "#/definitions/identification/definitions/dataElementUrn"
            }
          }
        },
        "definitions": {
          "$ref": "#/definitions/definitions"
        },
        "slots": {
          "$ref": "#/definitions/slots"
        },
        "valueDomain": {
          "$ref": "#/definitions/valueDomain"
        },
        "valueDomainUrn": {
          "$ref": "#/definitions/identification/definitions/valueDomainUrn"
        },
        "conceptAssociations": {
          "$ref": "#/definitions/conceptAssociations"
        }
      }
    },
    "namespace": {
      "additionalProperties": false,
      "required": ["identification", "definitions"],
      "properties": {
        "identification": {
          "required": ["status"],
          "additionalProperties": false,
          "properties": {
            "elementType": {
              "enum": [
                "NAMESPACE"
              ]
            },
            "hideNamespace": {
              "$ref": "#/definitions/identification/properties/hideNamespace"
            },
            "identifier": {
              "$ref": "#/definitions/identification/properties/identifier"
            },
            "namespaceId": {
              "$ref": "#/definitions/identification/properties/namespaceId"
            },
            "namespaceUrn": {
              "$ref": "#/definitions/identification/properties/namespaceUrn"
            },
            "revision": {
              "$ref": "#/definitions/identification/properties/revision"
            },
            "status": {
              "$ref": "#/definitions/identification/properties/status"
            },
            "urn": {
              "$ref": "#/definitions/identification/definitions/namespaceUrn"
            }
          }
        },
        "definitions": {
          "$ref": "#/definitions/definitions"
        },
        "slots": {
          "$ref": "#/definitions/slots"
        }
      }
    },
    "dataElementGroup": {
      "additionalProperties": false,
      "required": ["identification", "definitions"],
      "properties": {
        "identification": {
          "required": ["namespaceUrn", "status"],
          "not": {
            "required": ["hideNamespace"]
          },
          "additionalProperties": false,
          "properties": {
            "elementType": {
              "enum": [
                "DATAELEMENTGROUP"
              ]
            },
            "hideNamespace": {
              "$ref": "#/definitions/identification/properties/hideNamespace"
            },
            "identifier": {
              "$ref": "#/definitions/identification/properties/identifier"
            },
            "namespaceId": {
              "$ref": "#/definitions/identification/properties/namespaceId"
            },
            "namespaceUrn": {
              "$ref": "#/definitions/identification/properties/namespaceUrn"
            },
            "revision": {
              "$ref": "#/definitions/identification/properties/revision"
            },
            "status": {
              "$ref": "#/definitions/identification/properties/status"
            },
            "urn": {
              "$ref": "#/definitions/identification/definitions/dataElementGroupUrn"
            }
          }
        },
        "definitions": {
          "$ref": "#/definitions/definitions"
        },
        "slots": {
          "$ref": "#/definitions/slots"
        },
        "members": {
          "$ref": "#/definitions/members"
        }
      }
    },
    "record": {
      "additionalProperties": false,
      "required": ["identification", "definitions"],
      "properties": {
        "identification": {
          "required": ["namespaceUrn", "status"],
          "not": {
            "required": ["hideNamespace"]
          },
          "additionalProperties": false,
          "properties": {
            "elementType": {
              "enum": [
                "RECORD"
              ]
            },
            "hideNamespace": {
              "$ref": "#/definitions/identification/properties/hideNamespace"
            },
            "identifier": {
              "$ref": "#/definitions/identification/properties/identifier"
            },
            "namespaceId": {
              "$ref": "#/definitions/identification/properties/namespaceId"
            },
            "namespaceUrn": {
              "$ref": "#/definitions/identification/properties/namespaceUrn"
            },
            "revision": {
              "$ref": "#/definitions/identification/properties/revision"
            },
            "status": {
              "$ref": "#/definitions/identification/properties/status"
            },
            "urn": {
              "$ref": "#/definitions/identification/definitions/recordUrn"
            }
          }
        },
        "definitions": {
          "$ref": "#/definitions/definitions"
        },
        "slots": {
          "$ref": "#/definitions/slots"
        },
        "members": {
          "$ref": "#/definitions/members"
        }
      }
    }
  },
  "required": [
    "identification"
  ],
  "properties": {
    "identification": {
      "properties": {
        "elementType": {
          "type": "string",
          "enum": [
            "DATAELEMENT",
            "DATAELEMENTGROUP",
            "RECORD",
            "NAMESPACE",
            "DESCRIBED_VALUE_DOMAIN",
            "ENUMERATED_VALUE_DOMAIN",
            "PERMISSIBLE_VALUE"
          ]
        }
      }
    }
  },
  "allOf": [
    {
      "if": {
        "properties": {
          "identification": {
            "properties": {
              "elementType": {
                "enum": [
                  "NAMESPACE"
                ]
              }
            }
          }
        }
      },
      "then": {
        "$ref": "#/definitions/namespace"
      }
    },
    {
      "if": {
        "properties": {
          "identification": {
            "properties": {
              "elementType": {
                "enum": [
                  "DATAELEMENT"
                ]
              }
            }
          }
        }
      },
      "then": {
        "$ref": "#/definitions/dataElement"
      }
    },
    {
      "if": {
        "properties": {
          "identification": {
            "properties": {
              "elementType": {
                "enum": [
                  "DATAELEMENTGROUP"
                ]
              }
            }
          }
        }
      },
      "then": {
        "$ref": "#/definitions/dataElementGroup"
      }
    },
    {
      "if": {
        "properties": {
          "identification": {
            "properties": {
              "elementType": {
                "enum": [
                  "RECORD"
                ]
              }
            }
          }
        }
      },
      "then": {
        "$ref": "#/definitions/record"
      }
    },
    {
      "if": {
        "properties": {
          "identification": {
            "properties": {
              "elementType": {
                "enum": [
                  "PERMISSIBLE_VALUE"
                ]
              }
            }
          }
        }
      },
      "then": {
        "$ref": "#/definitions/permittedValue"
      }
    },
    {
      "if": {
        "properties": {
          "identification": {
            "properties": {
              "elementType": {
                "enum": [
                  "DESCRIBED_VALUE_DOMAIN",
                  "ENUMERATED_VALUE_DOMAIN"
                ]
              }
            }
          }
        }
      },
      "then": {
        "$ref": "#/definitions/valueDomain"
      }
    }
  ]
}